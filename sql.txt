-- DS: r_ds_ircm
-- Creator code IN-list for campaigns 31202 & 31203
SELECT GROUP_CONCAT("'", LOWER(promo_code), "'" ORDER BY promo_code SEPARATOR ',') AS in_list
FROM ircm_promocode
WHERE ircm_campaign_id IN (31202, 31203);


-- DRAFT [singlestore] Orders with Creator promo codes (31202/31203) â€“ Oct 2025
SELECT
  advertiser_id,
  COUNT(DISTINCT oid) AS orders_with_creator_codes
FROM conversion_fact
WHERE advertiser_id IN (6006417, 6006625)   -- Motatos DACH + Nordics
  AND event_datetime >= '2025-10-01'
  AND event_datetime <  '2025-11-01'
  AND promo_code IS NOT NULL
  AND promo_code <> ''
  AND LOWER(promo_code) IN (
    -- paste the GROUP_CONCAT output here
  )
GROUP BY advertiser_id
ORDER BY advertiser_id;
