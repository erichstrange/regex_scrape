SELECT
  action_date,
  doe,
  oid,
  action_tracker_id
FROM irac_action2
WHERE campaign_id = 16636
  AND action_tracker_id = 31842
  AND action_date >= '2025-12-08'
ORDER BY doe DESC
LIMIT 1000;


SELECT
  child.action_date        AS child_date,
  child.doe                AS child_doe,
  child.oid                AS child_oid,
  child.action_tracker_id  AS child_tracker,
  parent.action_date       AS parent_date,
  parent.doe               AS parent_doe,
  parent.oid               AS parent_oid
FROM irac_action2 child
LEFT JOIN irac_action2 parent
  ON parent.campaign_id = child.campaign_id
 AND parent.action_tracker_id = 31842
WHERE child.campaign_id = 16636
  AND child.action_tracker_id IN (31843, 31844)
  AND child.action_date >= '2025-12-08'
ORDER BY child.doe DESC
LIMIT 100;


-- DRAFT: recent Online Leads â€“ check customer_id
-- DataSource: r_ds_iraction_sharded
SELECT
  action_date,
  doe,
  oid,
  customer_id,
  action_tracker_id
FROM irac_action2
WHERE campaign_id = 16636         -- Paychex
  AND action_tracker_id = 31842   -- Online Lead
  AND action_date >= '2025-12-08' -- since fix
ORDER BY doe DESC
LIMIT 200;



-- DRAFT: recent children and whether they have a matching parent by customer_id
-- DataSource: r_ds_iraction_sharded
SELECT
  child.action_date        AS child_date,
  child.doe                AS child_doe,
  child.oid                AS child_oid,
  child.action_tracker_id  AS child_tracker,
  child.customer_id        AS child_customer_id,
  parent.action_date       AS parent_date,
  parent.doe               AS parent_doe,
  parent.oid               AS parent_oid,
  parent.customer_id       AS parent_customer_id
FROM irac_action2 child
LEFT JOIN irac_action2 parent
  ON parent.campaign_id = child.campaign_id
 AND parent.action_tracker_id = 31842           -- Online Lead
 AND parent.customer_id = child.customer_id     -- *** key to chaining ***
WHERE child.campaign_id = 16636
  AND child.action_tracker_id IN (31843, 31844) -- Qualified / Recycles
  AND child.action_date >= '2025-12-08'
ORDER BY child.doe DESC
LIMIT 200;
