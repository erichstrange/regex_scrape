-- Detailed click review for Uber Rides Global â€“ Ad 1063662
SELECT
  cf.campaign_id,
  cf.publisher_id,
  cf.event_datetime,
  JSON_EXTRACT_STRING(cf.json, 'inboundLink')       AS tracking_link,
  cf.click_id,
  ad.ad_id,
  ad.name                                            AS ad_name,
  JSON_EXTRACT_STRING(cf.json, 'blockingRule')      AS blocking_rule,
  JSON_EXTRACT_STRING(cf.json, 'ruleName')          AS rule_name,
  cf.method,
  cf.classification,
  cf.landing_page_url
FROM click_fact cf
LEFT JOIN ad_dim ad ON cf.ad_dim_id = ad.id
WHERE cf.advertiser_id = 256602          -- Uber Rides Global account
  AND cf.campaign_id  = 5335             -- Program ID
  AND ad.ad_id        = 1063662          -- The ad in question
  AND cf.publisher_id = 3019504          -- (run again with 2197213)
  AND cf.event_datetime >= '2025-10-23'
  AND cf.event_datetime <  '2025-10-26'
ORDER BY cf.event_datetime DESC;


SELECT publisher_id, COUNT(*) clicks
FROM click_fact
WHERE advertiser_id = 256602
  AND campaign_id = 5335
  AND publisher_id IN (3019504,2197213)
  AND event_datetime >= '2025-10-23'
  AND event_datetime <  '2025-10-26'
GROUP BY 1
ORDER BY clicks DESC;


SELECT *
FROM trkcfg.trkcfg_global_click_filter_config
WHERE publisher_id IN (3019504,2197213);
