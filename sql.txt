-- [iraction_sharded] small, indexed pull by OID + campaign
SELECT action_id, action_date, campaign_id, publisher_id,
       ref_profile_id, ref_url, ref_domain, ref_landingpage_url, ref_user_agent, oid
FROM irac_action2
WHERE campaign_id = 3899
  AND oid IN ('4649748041','4649667754','4649551514');


-- [actionlogging_sharded] authoritative mapping of conversion â†” referral
SELECT action_id, ref_type, click_id, ref_campaign_id, publisher_id, profile_id, event_datetime
FROM ir_referrer
WHERE action_id IN ('<paste_action_id_1>','<paste_action_id_2>','<paste_action_id_3>')
ORDER BY action_id, event_datetime;


-- [singlestore] fetch precise click rows by click_id to avoid wide date scans
SELECT
  cf.event_datetime,
  cf.advertiser_id,
  cf.campaign_id,
  cf.publisher_id,
  cf.profile_id,
  cf.click_id,
  cf.classification,         -- PAYABLE/TRACKED/FILTERED/BLOCKED/etc.
  cf.method,                 -- GET/POST/REDIRECT
  JSON_EXTRACT_STRING(cf.json,'blockingRule') AS blocking_rule,
  JSON_EXTRACT_STRING(cf.json,'ruleName')     AS rule_name,
  cf.landing_page_url,
  cf.landing_page_url_noquery
FROM click_fact cf
WHERE cf.click_id IN ('<click_id_1>','<click_id_2>','<click_id_3>')
ORDER BY cf.event_datetime;
