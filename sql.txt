SELECT DISTINCT mediapartner_id AS mpid
FROM ir_api_log
WHERE iram_account_id = 5804675
  AND ircm_campaign_id = 33961
  AND type = 'Conversion'
  AND submit_date >= '2025-10-01' AND submit_date < '2025-10-06'
ORDER BY mpid;


SELECT *
FROM ircm_signedcontract
WHERE ircm_campaign_id = 33961
  AND iram_publisher_id IN (6181753);


SELECT sc.iram_publisher_id AS mpid,
       sc.ircm_campaign_id,
       sc.ircm_ioterms_id,
       sc.date_contract_start,
       sc.date_contract_end
FROM ircm_signedcontract sc
WHERE sc.ircm_campaign_id = 33961
  AND sc.iram_publisher_id = 6569947
ORDER BY sc.date_contract_start;


SELECT
  st.id,
  st.name AS scheduled_term_name,
  st.start_date,
  st.end_date,
  JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[0].actionTracker')) AS tracker_1,
  JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[1].actionTracker')) AS tracker_2,
  JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[2].actionTracker')) AS tracker_3,
  JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[3].actionTracker')) AS tracker_4
FROM ircm_scheduled_terms st
WHERE st.ircm_campaign_id = 33961
  AND st.start_date >= '2025-10-01'
ORDER BY st.start_date DESC;
