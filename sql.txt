SELECT DATE(event_datetime) AS d, COUNT(*) AS clicks
FROM click_fact
WHERE advertiser_id = 1211624
  AND publisher_id  = 3311071
  AND campaign_id   = 8119
  AND event_datetime >= '2025-09-01' AND event_datetime < '2025-10-01'
GROUP BY DATE(event_datetime)
ORDER BY d;


SELECT
  cf.campaign_id,
  cf.event_datetime,
  JSON_EXTRACT_STRING(cf.json, 'inboundLink') AS tracking_link,
  cf.click_id,
  cf.profile_id,
  ad.ad_id,
  ad.name AS ad_name,
  JSON_EXTRACT_STRING(cf.json, 'blockingRule') AS blocking_rule,
  JSON_EXTRACT_STRING(cf.json, 'ruleName')     AS rule_name,
  cf.landing_page_url,
  cf.pub_subid1, cf.pub_subid2, cf.pub_subid3, cf.pub_subid4,
  cf.method, cf.classification,
  cf.cpc_contract_id, cf.cpc_adv_raw_payout, cf.cpc_error_code,
  cf.cpc_payout_trace, cf.cpc_payable
FROM click_fact cf
LEFT JOIN ad_dim ad ON cf.ad_dim_id = ad.id
WHERE cf.advertiser_id = 1211624
  AND cf.publisher_id  = 3311071
  AND cf.campaign_id   = 8119
  AND cf.event_datetime >= '2025-09-29' AND cf.event_datetime < '2025-10-01'
ORDER BY cf.event_datetime DESC;


SELECT cf.ref_domain, COUNT(*) AS clicks
FROM click_fact cf
WHERE cf.advertiser_id = 1211624
  AND cf.publisher_id  = 3311071
  AND cf.campaign_id   = 8119
  AND cf.event_datetime >= '2025-09-01' AND cf.event_datetime < '2025-10-01'
GROUP BY cf.ref_domain
ORDER BY clicks DESC
LIMIT 50;


SELECT
  COALESCE(JSON_EXTRACT_STRING(cf.json, 'blockingRule'), 'none') AS blocking_rule,
  cf.classification,
  COUNT(*) AS clicks
FROM click_fact cf
WHERE cf.advertiser_id = 1211624
  AND cf.publisher_id  = 3311071
  AND cf.campaign_id   = 8119
  AND cf.event_datetime >= '2025-09-01' AND cf.event_datetime < '2025-10-01'
GROUP BY 1,2
ORDER BY clicks DESC;



SELECT action_id, action_date, action_type, campaign_id, action_tracker_id, oid,
       publisher_id, ircm_terms_id, payout_group_id, payout_trace, ref_profile_id,
       ref_url, ref_domain, pub_subid1, pub_subid2, pub_subid3, pub_subid4, batch_id,
       metadata, ref_user_agent, adv_note, str1, str2, adj_reason, adv_currency,
       cart_currency, raw_currency, pub_currency, contract_currency, agency_currency,
       adv_saleamt, cart_saleamt, pub_saleamt, sku, category, client_cost, item_json, order_json
FROM irac_action2
WHERE campaign_id = '8119'
  AND action_id IN (
    '8119.6482.952546','8119.6482.885845','8119.6482.739739','8119.6482.453952','8119.6482.152044',
    '8119.6473.979147','8119.6468.992489','8119.6468.897481','8119.6470.401160','8119.6476.113466'
  );



-- Run for a handful of action_ids from 2A; example set from nonâ€‘yeahpromos referrers:
SELECT * FROM ir_referrer
WHERE action_id IN ('8119.6482.952546','8119.6482.739739','8119.6481.893533','8119.6482.453952')
ORDER BY id;



SELECT oid, action_id, platform AS device, device_family AS device_type, os_name AS OS, ua_name AS User_Agent
FROM action_fact fact
INNER JOIN client_dim cld ON cld.id = ref_client_dim_id
WHERE fact.action_datetime >= '2025-09-01 00:00:00' AND fact.action_datetime < '2025-10-01 00:00:00'
  AND advertiser_id = 1211624
  AND campaign_id   = 8119
  AND oid IN ('74777782CUS','74777240CUS','74776201CUS','74774194CUS','74771670CUS',
              '74777732CUS','74777060CUS','74776918CUS','74776472CUS','74776304CUS');



SELECT rpef.conversion_event_datetime,
       rpef.conversion_oid,
       rpef.event_id, rpef.event_type, rpef.event_datetime,
       md.media_name, md.media_type, md.media_channel_name,
       rpef.referring_url, rpef.click_order_first_to_last,
       rpef.referral_is_winner, rpef.referral_is_introducer, rpef.referral_is_influencer, rpef.referral_is_closer
FROM radius_path_event_fact rpef
JOIN media_dim md ON md.id = rpef.event_media_dim_id
WHERE rpef.campaign_id = 8119
  AND rpef.conversion_oid IN ('74777782CUS','74776201CUS','74774194CUS')
ORDER BY rpef.conversion_event_datetime, rpef.click_order_first_to_last;


SELECT sc.iram_publisher_id, sc.ircm_campaign_id, iot.credit_group
FROM ircm_signedcontract sc
LEFT JOIN ircm_ioterms iot ON iot.id = sc.ircm_ioterms_id
WHERE sc.iram_publisher_id = '3311071'
  AND sc.ircm_campaign_id = '8119'
  AND sc.date_contract_end IS NULL;
