-- [singlestore] click_fact_by_campaign_ad_template.sql (reference)
SELECT
  cf.campaign_id,
  cf.event_datetime,
  JSON_EXTRACT_STRING(cf.json, 'inboundLink') AS tracking_link,
  cf.click_id,
  cf.profile_id,
  ad.ad_id,
  ad.name AS ad_name,
  JSON_EXTRACT_STRING(cf.json, 'blockingRule') AS blocking_rule,
  JSON_EXTRACT_STRING(cf.json, 'ruleName') AS rule_name,
  cf.landing_page_url,
  cf.pub_subid1, cf.pub_subid2, cf.pub_subid3, cf.pub_subid4,
  cf.method,
  cf.classification
FROM click_fact cf
LEFT JOIN ad_dim ad ON cf.ad_dim_id = ad.id
WHERE cf.event_datetime >= '2025-10-06' AND cf.event_datetime < '2025-10-09'
  AND cf.landing_page_url LIKE '%walmart.com/sc/cart/addToCart%'
ORDER BY cf.event_datetime DESC;




SELECT event_datetime, advertiser_id, campaign_id, click_id, method, classification,
       referring_url, landing_page_url, ua_name, os_name, platform, json
FROM click_fact
WHERE click_id IN ('2s2wGRWmixycWEVSyNXYVya-Ukp3bYwe8TPb1A0',
                   '2s2wGRWmixycWEVSyNXYVya-Ukp3bYUv8TPb1A0')
  AND event_datetime >= '2025-10-06' AND event_datetime < '2025-10-10';



-- [iram] get_account_by_id.sql
SELECT * FROM iram_account WHERE id = 1356456;
