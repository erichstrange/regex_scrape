SELECT
    ins.name AS template_term_name
  , st.name AS scheduled_term_name
  , st.start_date
  , st.end_Date
  , atr1.name AS tracker_name_1
  , JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[0].actionTracker')) AS payout_tracker_1
  , atr2.name AS tracker_name_2
  , JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[1].actionTracker')) AS payout_tracker_2
  , atr3.name AS tracker_name_3
  , JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[2].actionTracker')) AS payout_tracker_3
  , atr4.name AS tracker_name_4
  , JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[3].actionTracker')) AS payout_tracker_4
  , st.archived
  , st.doe
  , st.uoe
  , st.dlu
  , st.ulu
FROM ircm_scheduled_terms st
INNER JOIN ircm_insertionorder ins
  ON ins.id = st.ircm_insertionorder_id

LEFT JOIN ircm_actiontracker atr1
  ON atr1.ircm_campaign_id = st.ircm_campaign_id
 AND atr1.id = JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[0].actionTracker'))

LEFT JOIN ircm_actiontracker atr2
  ON atr2.ircm_campaign_id = st.ircm_campaign_id
 AND atr2.id = JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[1].actionTracker'))

LEFT JOIN ircm_actiontracker atr3
  ON atr3.ircm_campaign_id = st.ircm_campaign_id
 AND atr3.id = JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[2].actionTracker'))

LEFT JOIN ircm_actiontracker atr4
  ON atr4.ircm_campaign_id = st.ircm_campaign_id
 AND atr4.id = JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[3].actionTracker'))

WHERE st.ircm_campaign_id = 5048
-- AND st.start_date >= NOW()     -- uncomment for upcoming-only
ORDER BY st.start_date DESC;
+--------------------+---------------------+------------+----------+----------------+------------------+----------------+------------------+----------------+------------------+----------------+------------------+----------+-----+-----+-----+-----+
| template_term_name | scheduled_term_name | start_date | end_Date | tracker_name_1 | payout_tracker_1 | tracker_name_2 | payout_tracker_2 | tracker_name_3 | payout_tracker_3 | tracker_name_4 | payout_tracker_4 | archived | doe | uoe | dlu | ulu |
+--------------------+---------------------+------------+----------+----------------+------------------+----------------+------------------+----------------+------------------+----------------+------------------+----------+-----+-----+-----+-----+
+--------------------+---------------------+------------+----------+----------------+------------------+----------------+------------------+----------------+------------------+----------------+------------------+----------+-----+-----+-----+-----+






select *
from ircm_signedcontract
where ircm_campaign_id = 5048
  and iram_publisher_id = 2533699;

-- result in query(11).csv



  SELECT
  sc.iram_publisher_id,
  sc.ircm_campaign_id,
  iot.credit_group
from ircm_signedcontract sc
LEFT JOIN ircm_ioterms iot on iot.id = sc.ircm_ioterms_id
WHERE sc.iram_publisher_id = '2533699'
  AND ircm_campaign_id = '5048'
  AND sc.date_contract_end is null;
 +-------------------+------------------+--------------+
| iram_publisher_id | ircm_campaign_id | credit_group |
+-------------------+------------------+--------------+
|           2533699 |             5048 | Ê˜            |
+-------------------+------------------+--------------+



select *
from ircm_onlineactionterms
where ircm_ioterms_id in (
  select distinct ircm_ioterms_id
  from ircm_signedcontract
  where ircm_campaign_id = 5048
    and iram_publisher_id = 2533699
    and date_contract_end is null
);
-- result in query(12).csv

select *
from ircm_pendingcontract pc
inner join ircm_campaign ic on ic.id = pc.ircm_campaign_id
where pc.iram_publisher_id = 2533699
  and pc.ircm_campaign_id = 5048;
  and pc.ircm_campaign_id = 5048;
-- result in query(13).csv
