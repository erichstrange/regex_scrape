SELECT
  cf.campaign_id, cf.event_datetime,
  JSON_EXTRACT_STRING(cf.json,'inboundLink') AS tracking_link,
  cf.click_id, cf.profile_id, ad.ad_id, ad.name AS ad_name,
  JSON_EXTRACT_STRING(cf.json,'blockingRule') AS blocking_rule,
  JSON_EXTRACT_STRING(cf.json,'ruleName') AS rule_name,
  landing_page_url, cf.pub_subid1, cf.pub_subid2, cf.pub_subid3, cf.pub_subid4,
  cf.method, cf.classification, cf.cpc_contract_id,
  cf.cpc_adv_raw_payout, cf.cpc_error_code, cf.cpc_payout_trace, cf.cpc_payable
FROM click_fact cf
LEFT JOIN ad_dim ad ON cf.ad_dim_id = ad.id
WHERE advertiser_id = 5819706      -- Chime
  AND cf.publisher_id = <Nerdwallet_partner_id>
  AND cf.campaign_id  = 28165       -- Program ID supplied
  AND event_datetime >= '2025-09-01' AND event_datetime < '2025-10-01'
ORDER BY cf.event_datetime DESC;
