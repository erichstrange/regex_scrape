-- [ODS] Check last eBay batch import(s) for account 1354875
select process_entity_count, tot_entity_count, error_file_ready
from irods.ir_ftp_batch_log
where iram_account_id = 1354875
order by doe desc
limit 1;


-- [IRAM] Verify advertiser record exists / state
SELECT * FROM iram_account
WHERE id = 1354875;


-- [ODS] List recent eBay SFTP batches (to locate reconciliation runs)
SELECT doe, directory, filename, process_entity_count, tot_entity_count, error_file_ready
FROM irods.ir_ftp_batch_log
WHERE iram_account_id = 1354875
ORDER BY doe DESC
LIMIT 50;


-- DRAFT [r_ds_ods]: confirm reconciliation payload content for Manage Account Links
-- Assumes reconciliation files are logged with batch_id/filename in ODS API log.
-- (Please peer-review table/column names before execution.)
SELECT batch_id, filename, doe, payload
FROM ir_api_log
WHERE iram_account_id = 1354875
  AND (filename ILIKE '%reconciliation%' OR filename ILIKE '%account_links%')
ORDER BY doe DESC
LIMIT 10;


-- [IRAM] Advertiser metadata
SELECT * FROM iram_account WHERE id = 1354875;
