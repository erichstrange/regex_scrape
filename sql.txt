-- Vetted: "Upcoming scheduled terms & trackers" (adapted to show all terms)
SELECT 
  st.name AS scheduled_term_name,
  st.start_date, st.end_date,
  JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[0].actionTracker')) AS tracker_1,
  JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON), '$.actionTrackers[1].actionTracker')) AS tracker_2
FROM ircm_scheduled_terms st
WHERE st.ircm_campaign_id = 33961
ORDER BY st.start_date DESC;

+---------------------+------------+----------+-----------+-----------+
| scheduled_term_name | start_date | end_date | tracker_1 | tracker_2 |
+---------------------+------------+----------+-----------+-----------+
+---------------------+------------+----------+-----------+-----------+

-- MPIDs that posted conversions to 33961 and their contract state
WITH conv_mpid AS (
  SELECT DISTINCT mediapartner_id AS mpid
  FROM ir_api_log
  WHERE iram_account_id = 5804675
    AND ircm_campaign_id = 33961
    AND type = 'Conversion'
    AND submit_date >= '2025-10-01' AND submit_date < '2025-10-06'
)
SELECT
  m.mpid,
  CASE
    WHEN sc.id IS NOT NULL THEN 'signed'
    WHEN pc.id IS NOT NULL THEN 'pending'
    ELSE 'none'
  END AS contract_state
FROM conv_mpid m
LEFT JOIN ircm_signedcontract sc
  ON sc.iram_publisher_id = m.mpid
 AND sc.ircm_campaign_id = 33961
 AND sc.date_contract_end IS NULL
LEFT JOIN ircm_pendingcontract pc
  ON pc.iram_publisher_id = m.mpid
 AND pc.ircm_campaign_id = 33961;

You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'conv_mpid AS (
SELECT DISTINCT mediapartner_id AS mpid
FROM ir_api_log
WHE' at line 2
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'conv_mpid AS (
SELECT DISTINCT mediapartner_id AS mpid
FROM ir_api_log
WHE' at line 2; nested exception is java.sql.SQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'conv_mpid AS (
SELECT DISTINCT mediapartner_id AS mpid
FROM ir_api_log
WHE' at line 2