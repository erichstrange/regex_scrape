SELECT
  c.conversion_event_id,
  ps.first_event_time,
  c.conversion_time,
  TIMESTAMPDIFF(DAY, ps.first_event_time, c.conversion_time) AS path_days
FROM convs c
JOIN path_start ps USING (conversion_event_id)
ORDER BY path_days DESC
LIMIT 50;


-- Vetted skeleton from “Retrieve the sequence of events leading to a specific conversion”
-- Data source: r_ds_singlestore
SELECT event_id, event_type, event_datetime, event_media_id, event_media_dim_id,
       md.media_name, md.media_type, md.media_channel_name, referring_url,
       click_order_first_to_last, referral_is_winner, referral_is_introducer,
       referral_is_influencer, referral_is_closer
FROM radius_path_event_fact rpef
JOIN media_dim md ON md.id = rpef.event_media_dim_id
WHERE rpef.conversion_event_id = '<one of the top offenders from step B>'
ORDER BY event_datetime ASC;
