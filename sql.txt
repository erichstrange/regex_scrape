SELECT
  CASE
    WHEN li.txn_code = 'CPC' THEN 'CPC'
    WHEN li.txn_code = 'MAKE_GOOD' THEN 'No Event Type / Other Costs'
    ELSE li.txn_code
  END AS statement_bucket,
  SUM(li.adv_net_amount) AS amount_adv_usd
FROM iracct.iracct_campaign_recipient_generated_lineitem li
WHERE li.iracct_recipientgenerated_invoice_id = 9699125
GROUP BY 1
ORDER BY 1;


SELECT
  li.id, li.txn_code, li.num_actions,
  li.adv_net_amount AS amount_adv_usd,
  li.event_month, li.event_year
FROM iracct.iracct_campaign_recipient_generated_lineitem li
WHERE li.iracct_recipientgenerated_invoice_id = 9699125
  AND li.txn_code = 'CPC'
ORDER BY li.adv_net_amount DESC;  -- positive first, then the negative


SELECT
  rgi.id,
  rgi.iram_publisher_id,          -- 170911
  rgi.sequence_number,            -- 3482
  rgi.iram_advertiser_id,         -- 5819706
  rgi.month, rgi.year,
  rgi.date_generated, rgi.state
FROM iracct.iracct_recipientgenerated_invoice rgi
WHERE rgi.id = 9699125;
