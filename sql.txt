-- [IRAM, vetted] Retrieve user details for a specific account
SELECT u.id, ce.username, ce.email, ce.firstname, ce.lastname, u.state, ce.lastlogin_date, ce.doe, ce.dlu, ce.uoe, ce.ulu
FROM iram_usership u
JOIN core_estaleauser ce ON u.account_user_id = ce.id
WHERE u.irAccount_Id = "<accountId>"
ORDER BY ce.lastlogin_date DESC;


-- [IRAM, vetted] Roles by user & account (CORE confirmed)
select * from core_role where id in (
  select core_role_id from core_ap_role where core_ap_id = (
    select authorizationPrincipal_id from iram_usership
    where account_user_id = {userId} and irAccount_id = {accountId}
  )
);
