-- DRAFT EXAMPLE based on vetted conversion_fact pattern [TS, conversions, singlestore]:contentReference[oaicite:10]{index=10}
SELECT
  date_trunc('DAY', event_datetime) AS event_day,
  date_trunc('DAY', action_datetime) AS action_day,
  method,
  count(*) AS conversions
FROM conversion_fact
WHERE campaign_id = 27471
  AND event_datetime >= '2025-11-15'
  AND event_datetime <  '2025-11-23'
GROUP BY 1,2,3
ORDER BY event_day, action_day, method;



-- Based on vetted action_fact detail query [TS, conversions, irdw_imp/singlestore]:contentReference[oaicite:11]{index=11}
SELECT
  af.action_datetime,
  af.advertiser_id,
  af.campaign_id,
  af.publisher_id,
  atr.action_tracker_id,
  atr.action_tracker_name,
  af.method,
  af.batch_id,
  af.oid,
  af.adv_saleamt,
  af.adv_commission,
  af.adv_original_commission,
  af.ref_domain,
  af.ref_landingpage_url,
  af.pubsubid1,
  af.pubsubid2
FROM action_fact af
LEFT JOIN action_tracker_dim atr
  ON atr.id = af.action_tracker_dim_id
WHERE af.campaign_id = 27471
  AND af.action_datetime >= '2025-11-18'
  AND af.action_datetime <  '2025-11-19'
LIMIT 2000;
