-- iraction_sharded
SELECT
  action_date,
  action_id,
  oid,
  action_type,
  action_tracker_id,
  campaign_id,
  publisher_id,
  batch_id,
  ref_domain,
  ref_url
FROM irac_action2
WHERE campaign_id = 9383
  AND action_tracker_id = 16681      -- “Online Sale”
  AND action_date >= '2025-09-08'     -- <from>
  AND action_date <  '2025-10-09'     -- <to>, exclusive
ORDER BY action_date DESC
LIMIT 1000;


-- iraction_sharded
SELECT DISTINCT action_id, oid
FROM irac_action2
WHERE campaign_id = 9383
  AND action_tracker_id = 16681
  AND action_date >= '2025-09-08'
  AND action_date <  '2025-10-09'
ORDER BY action_id DESC;


-- ircm
SELECT
  ins.name  AS template_term_name,
  st.name   AS scheduled_term_name,
  st.start_date, st.end_date,
  atr1.name AS tracker_name_1,
  JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON),
    '$.actionTrackers[0].actionTracker')) AS payout_tracker_1
FROM ircm_scheduled_terms st
JOIN ircm_insertionorder ins ON ins.id = st.ircm_insertionorder_id
LEFT JOIN ircm_actiontracker atr1
  ON atr1.ircm_campaign_id = st.ircm_campaign_id
 AND atr1.id = JSON_UNQUOTE(JSON_EXTRACT(CAST(st.payout_json AS JSON),
    '$.actionTrackers[0].actionTracker'))
WHERE st.ircm_campaign_id = 9383
  AND st.end_date   >= '2025-09-08'
  AND st.start_date <  '2025-10-09'
ORDER BY st.start_date DESC;
