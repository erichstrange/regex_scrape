-- DRAFT: sample recent Online Leads for Paychex and see if customer_id is populated
-- DataSource: r_ds_iraction_sharded
SELECT
  action_date,
  doe,
  oid,
  customer_id,
  action_tracker_id
FROM irac_action2
WHERE campaign_id = 16636         -- Paychex
  AND action_tracker_id = 31842   -- Online Lead
  AND action_date >= '2025-12-08' -- adjust date to "since they deployed fix"
ORDER BY doe DESC
LIMIT 200;


-- DRAFT: for recent children, see if there is a matching 31842 parent by customer_id
-- DataSource: r_ds_iraction_sharded
SELECT
  child.action_date        AS child_date,
  child.doe                AS child_doe,
  child.oid                AS child_oid,
  child.action_tracker_id  AS child_tracker,
  child.customer_id,
  parent.action_date       AS parent_date,
  parent.doe               AS parent_doe,
  parent.oid               AS parent_oid
FROM irac_action2 child
LEFT JOIN irac_action2 parent
  ON parent.campaign_id = child.campaign_id
 AND parent.action_tracker_id = 31842     -- Online Lead
 AND parent.customer_id = child.customer_id
WHERE child.campaign_id = 16636
  AND child.action_tracker_id IN (31843, 31844)   -- Qualified / Recycles
  AND child.action_date >= '2025-12-08'           -- adjust as needed
ORDER BY child.doe DESC
LIMIT 200;


-- DRAFT: find recent events whose landing_page_url is the dev LP
-- Likely DataSource: r_ds_iraction_sharded (same family as ir_correlated_event usage in vetted queries)
SELECT
  oid,
  campaign_id,
  event_date,
  landing_page_url
FROM ir_correlated_event
WHERE campaign_id = 16636
  AND event_date >= '2025-12-08'        -- adjust window
  AND landing_page_url LIKE '%hefmart-paychex.pantheonsite.io%'
ORDER BY event_date DESC
LIMIT 200;


-- VETTED pattern â€“ failed events
SELECT * FROM ir_noreferrer_event
WHERE oid = '<dev_oid_from_above>'
  AND campaign_id = 16636;
-- DataSource: r_ds_iraction_sharded
