-- IO/Terms snapshot & audit around Oct 2 (window is adjustable)
SELECT
    it.id                AS ircm_ioterms_id,
    it.ircm_campaign_id,
    it.timezone,
    it.active_start_date,
    it.active_end_date,
    io.name              AS insertion_order_name,
    io.ulu               AS last_updated_by
FROM ircm_ioterms it
LEFT JOIN ircm_insertionorder io
  ON it.iram_advertiser_id = io.iram_advertiser_id
WHERE it.ircm_campaign_id = 4318
ORDER BY it.active_start_date DESC;

Unknown column 'it.ircm_campaign_id' in 'where clause'
Unknown column 'it.ircm_campaign_id' in 'where clause'; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'it.ircm_campaign_id' in 'where clause'



-- Who (partners) had signed/active contracts during the CPC-public window?
SELECT
    sc.iram_publisher_id,
    sc.ircm_campaign_id,
    sc.ircm_ioterms_id,
    sc.date_contract_begin,
    sc.date_contract_end
FROM ircm_signedcontract sc
WHERE sc.ircm_campaign_id = 4318
  AND sc.date_contract_begin < '2025-10-03'  -- end of window (adjust)
  AND (sc.date_contract_end IS NULL OR sc.date_contract_end >= '2025-10-02');

  Unknown column 'sc.date_contract_begin' in 'field list'
Unknown column 'sc.date_contract_begin' in 'field list'; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'sc.date_contract_begin' in 'field list'



SELECT
  cf.campaign_id,
  cf.event_datetime,
  cf.click_id,
  cf.profile_id,
  cf.classification,
  cf.cpc_contract_id,
  cf.cpc_adv_raw_payout,
  cf.cpc_error_code,
  cf.cpc_payout_trace,
  cf.cpc_payable
FROM click_fact cf
WHERE cf.campaign_id = 4318
  AND cf.advertiser_id = 230603          -- if different, weâ€™ll adjust
  AND cf.publisher_id IN (<partner ids from Step 2>)
  AND cf.event_datetime >= '2025-10-02'
  AND cf.event_datetime <  '2025-10-03'
ORDER BY cf.event_datetime;
