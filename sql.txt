/* ds_iraction_sharded */

SELECT
    d.action_id,
    d.code                AS disposition_code,
    d.message             AS disposition_reason,
    d.doe                 AS reversed_at_utc,
    a.ref_ip_address,     -- swap to device_ip if needed
    a.partner_id,
    a.event_date
FROM   irac_disposition_log AS d
JOIN   irac_action2          AS a
       ON a.id = d.action_id
WHERE  a.iram_advertiser_id = 5333971      -- Brooks Running
  AND  d.doe >= DATE_SUB(NOW(), INTERVAL 30 DAY)
ORDER  BY d.doe DESC
LIMIT 500;
