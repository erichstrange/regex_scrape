-- DRAFT â€” Data source: ircm
-- Vanity link inventory for advertiser 6321789 (Helium 10)
SELECT
    su.short_url,               -- e.g., i.helium10.com/xxxxxx or helium10.pxf.io/xxxxxx
    su.long_url,                -- destination landing page
    su.ircm_campaign_id,        -- program id (e.g., 37271)
    su.iram_publisher_id,       -- media partner id (creator/owner)
    su.archived,                -- TRUE/FALSE
    su.doe,                     -- created timestamp
    su.dlu                      -- last updated
FROM ircm_short_url su
JOIN ircm_campaign c ON c.id = su.ircm_campaign_id
WHERE c.iram_advertiser_id = 6321789
ORDER BY su.doe DESC;


SELECT
  CAST(su.short_url AS CHAR)               AS short_url,
  su.ircm_campaign_id,
  c.name                                    AS program_name,
  su.archived,
  su.ulu,
  su.dlu
FROM ircm_short_url su
JOIN ircm_campaign c
  ON su.ircm_campaign_id = c.id
WHERE c.iram_advertiser_id = 6321789
ORDER BY su.dlu DESC;


SELECT
  CAST(su.short_url AS CHAR) AS short_url,
  su.ircm_campaign_id, c.name AS program_name,
  su.archived, su.ulu, su.dlu
FROM ircm_short_url su
JOIN ircm_campaign c ON su.ircm_campaign_id = c.id
WHERE c.iram_advertiser_id = 6321789
  AND CAST(su.short_url AS CHAR) LIKE 'i.helium10.com/%'
ORDER BY su.dlu DESC;


... WHERE c.iram_advertiser_id = 6321789
  AND CAST(su.short_url AS CHAR) LIKE '%.pxf.io/%'
ORDER BY su.dlu DESC;
