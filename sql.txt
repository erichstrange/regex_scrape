-- Data Source: r_ds_icee_snapshot

-- What database is this data source pointing at?
SELECT DATABASE() AS current_db;

-- List tables so we see the actual names (e.g., program, relationship)
SELECT table_name
FROM information_schema.tables
WHERE table_schema = DATABASE()
ORDER BY table_name;

-- Find which table has PSI + radiuscampaign_id
SELECT table_name, column_name
FROM information_schema.columns
WHERE table_schema = DATABASE()
  AND column_name IN ('psi','radiuscampaign_id')
ORDER BY table_name, column_name;

-- Once you identify the correct program table (often named exactly `program`)
-- pull the PSI for MobileX (25438):
SELECT psi, radiuscampaign_id
FROM program
WHERE radiuscampaign_id = 25438;
-- Copy the PSI value for the next step (call it 'PSI_MobileX')



2)
-- Data Source: r_ds_icee_snapshot
-- Replace 'PSI_MobileX' with the value from step 1 (in quotes)

SELECT
  r.rsi,
  r.supply_psi,
  r.demand_psi,
  r.state,
  r.source,    -- raw source string (UI maps to "Other")
  r.doe,       -- created timestamp
  r.dlu,       -- last update timestamp
  r.uoe,       -- created by (user or service)
  r.ulu        -- last updated by
FROM relationship r
WHERE r.supply_psi = 'PSI_MobileX'
  AND r.doe >= '2025-10-15' AND r.doe < '2025-11-01'
ORDER BY r.doe DESC;


3)
-- Data Source: r_ds_iram
SELECT u.id, ce.username, ce.email, ce.firstname, ce.lastname, u.state, ce.lastlogin_date
FROM iram_usership u
JOIN core_estaleauser ce ON u.account_user_id = ce.id
WHERE ce.username IN ('paste','distinct','usernames','here')
ORDER BY ce.lastlogin_date DESC;
